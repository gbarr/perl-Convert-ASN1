#!/usr/local/bin/perl

print "1..44\n";

BEGIN { require 't/funcs.pl' }

use Convert::ASN1;

my $asn = Convert::ASN1->new;

btest 1, $asn->prepare(<<ASN1);

RSAPrivateKey ::= SEQUENCE {
		  version           Version,
		  modulus           INTEGER,  -- n
		  publicExponent    INTEGER,  -- e
		  privateExponent   INTEGER,  -- d
		  prime1            INTEGER,  -- p
		  prime2            INTEGER,  -- q
		  exponent1         INTEGER,  -- d mod (p-1)
		  exponent2         INTEGER,  -- d mod (q-1)
		  coefficient       INTEGER,  -- (inverse of q) mod p
		  otherPrimeInfos   EXPLICIT OtherPrimeInfos OPTIONAL
	  }

Version ::= INTEGER  --{  v1(0), v2(1), v3(2)  }

OtherPrimeInfos ::= SEQUENCE --SIZE(1..MAX) OF OtherPrimeInfo

		 OtherPrimeInfo ::= SEQUENCE {
			 prime             INTEGER,  -- ri
			 exponent          INTEGER,  -- di
			 coefficient       INTEGER   -- ti
		 }
ASN1

btest 2, my $parser = $asn->find('RSAPrivateKey');

my $t = 3;

## test
# Math::BigInt
# hex
# twos

my @testf = (
  ['Math::BigInt',  \&ntest],
  ['hex',           \&stest],
  ['twos',          \&stest],
);

use Math::BigInt;

my %keys = (
    't/rsa-4k.der'    =>    {
        modulus =>  [
            Math::BigInt->from_hex('0x9e28b0de6b9f80b4763b27ebef719d9b75a2628334c3dbf192d323abc16767e69771c1ee94f94dc3e945b49bc8b07e6add15f3f4038d00bd972449f70a8195df93f86a8611ec1c5aa7e902bf769db8955e7ca78a2734ba6386c1ecb672a2f133e83c1e43f51cb44842c229b7e1b93e1236885c3972d4956ba1fd4f84fdf21b2fc61bc2dc3cde49c879f0f0e66eadd207c0a8518893b920a15fa981d3abbf05c06369f33acfaa967749d8b47ed8bb33f07de17c2592f49033cd240dc71d710f58258ed9f1b6b9f7a0928a4af370a2ef188e47d2ee6b23bf9449cb317b5b44ca52721b81c4689a2df98847e55d5099fd7c0f1c892a91768b92003b799dd1d659199d14c8a66a76922230114b6df660bd4f2ed8c8fd6cab02e6a4e3b89acd2acddf5ff5071c76f926e9cf591212c357d18ff379cb8bfcce24602ec6ba5d131c8f9f71d9ad789072adc9c88b52df637a911d4595ec3cec1681990e53a4c857eac10df8db207ba1f4a22a98fff80ae64c15bf1c0a8971b7344facfd70bafcd440b8711a99a5a445d9087197dbde0f10ed84ccb95e7563a9ecc32cf1a2e9281d0acf7e3362383fb8ae38a26e0dae125d26655ae3541c7b4720110b3d6df1e487828b5943307a4eb63b680cd4d37fe0ce733e5b3e8d64cbf218e188c2deaa9bdd21330da30952305170daeefd6961416978a48d1e520ec32a40fd38caceb2e96f4f21c1'),
            '0x9e28b0de6b9f80b4763b27ebef719d9b75a2628334c3dbf192d323abc16767e69771c1ee94f94dc3e945b49bc8b07e6add15f3f4038d00bd972449f70a8195df93f86a8611ec1c5aa7e902bf769db8955e7ca78a2734ba6386c1ecb672a2f133e83c1e43f51cb44842c229b7e1b93e1236885c3972d4956ba1fd4f84fdf21b2fc61bc2dc3cde49c879f0f0e66eadd207c0a8518893b920a15fa981d3abbf05c06369f33acfaa967749d8b47ed8bb33f07de17c2592f49033cd240dc71d710f58258ed9f1b6b9f7a0928a4af370a2ef188e47d2ee6b23bf9449cb317b5b44ca52721b81c4689a2df98847e55d5099fd7c0f1c892a91768b92003b799dd1d659199d14c8a66a76922230114b6df660bd4f2ed8c8fd6cab02e6a4e3b89acd2acddf5ff5071c76f926e9cf591212c357d18ff379cb8bfcce24602ec6ba5d131c8f9f71d9ad789072adc9c88b52df637a911d4595ec3cec1681990e53a4c857eac10df8db207ba1f4a22a98fff80ae64c15bf1c0a8971b7344facfd70bafcd440b8711a99a5a445d9087197dbde0f10ed84ccb95e7563a9ecc32cf1a2e9281d0acf7e3362383fb8ae38a26e0dae125d26655ae3541c7b4720110b3d6df1e487828b5943307a4eb63b680cd4d37fe0ce733e5b3e8d64cbf218e188c2deaa9bdd21330da30952305170daeefd6961416978a48d1e520ec32a40fd38caceb2e96f4f21c1',
            '0x009e28b0de6b9f80b4763b27ebef719d9b75a2628334c3dbf192d323abc16767e69771c1ee94f94dc3e945b49bc8b07e6add15f3f4038d00bd972449f70a8195df93f86a8611ec1c5aa7e902bf769db8955e7ca78a2734ba6386c1ecb672a2f133e83c1e43f51cb44842c229b7e1b93e1236885c3972d4956ba1fd4f84fdf21b2fc61bc2dc3cde49c879f0f0e66eadd207c0a8518893b920a15fa981d3abbf05c06369f33acfaa967749d8b47ed8bb33f07de17c2592f49033cd240dc71d710f58258ed9f1b6b9f7a0928a4af370a2ef188e47d2ee6b23bf9449cb317b5b44ca52721b81c4689a2df98847e55d5099fd7c0f1c892a91768b92003b799dd1d659199d14c8a66a76922230114b6df660bd4f2ed8c8fd6cab02e6a4e3b89acd2acddf5ff5071c76f926e9cf591212c357d18ff379cb8bfcce24602ec6ba5d131c8f9f71d9ad789072adc9c88b52df637a911d4595ec3cec1681990e53a4c857eac10df8db207ba1f4a22a98fff80ae64c15bf1c0a8971b7344facfd70bafcd440b8711a99a5a445d9087197dbde0f10ed84ccb95e7563a9ecc32cf1a2e9281d0acf7e3362383fb8ae38a26e0dae125d26655ae3541c7b4720110b3d6df1e487828b5943307a4eb63b680cd4d37fe0ce733e5b3e8d64cbf218e188c2deaa9bdd21330da30952305170daeefd6961416978a48d1e520ec32a40fd38caceb2e96f4f21c1',
          ],
        privateExponent =>  [
            Math::BigInt->from_hex('0x62a79f2c1e95f002a17d64f996f2980d50e369efce0a1e38220df24240f1efadb6ea0ebe73cecee355af55699756008548435958ec9e17c82b6f477401e9b3433359d198afb5483a8462a48429c9584a54160dabefa8c45b30c3e694280ddbc73525cafb38fa1ebab469c8fc1aa12246da1d54e9c0e73a0d598e58fbec2c092953ba1d62a3d544d0f8bf82853aa4d24e63ae9aad46f8439265c9a66212cfa516ccec59fc656d534e35922784b84c8da985dc11449ed64edd01296c2eb7febe438da9fde8f8c227e4d183d21ce835ba4ee6f1867192034a8d853a6a33384b40a90ce47b9db861f42ba306b5dbef5b1ef333b9e915d486cda8d4dc44905d44076f279acb6272c8a28a7cb580fe4e33a4cddc8d00976c2a0bf112fc9cd5bc690d87d88811d8946d80b26534b35dc451b87304b0c92834abb9d6cd88bb1111e47dccda156abac3a82174b5b2f9a7388a7d19b499911330b47353cae0be0aa0b797cde922981f6c7b8becd91735eb50d92e35cc14995889c35cb887b3b73d49a2c5e4fde822407668a19ec316dde697f44eca932e0c7829e5060e80a418b842c4c77882f94b57d7bd974fcd109f35206558aa201c2435a2cd16726a18ccd3a664533f206c9feaf7c2ac94f704cbf3c7eda7fa6f4f3d5e346c5b60f42bf55d656c345b8284c21253153d3137a02635f80bf2f84dc64cf32ff8cbb50810f3c932a3a5c1'),
            '0x62a79f2c1e95f002a17d64f996f2980d50e369efce0a1e38220df24240f1efadb6ea0ebe73cecee355af55699756008548435958ec9e17c82b6f477401e9b3433359d198afb5483a8462a48429c9584a54160dabefa8c45b30c3e694280ddbc73525cafb38fa1ebab469c8fc1aa12246da1d54e9c0e73a0d598e58fbec2c092953ba1d62a3d544d0f8bf82853aa4d24e63ae9aad46f8439265c9a66212cfa516ccec59fc656d534e35922784b84c8da985dc11449ed64edd01296c2eb7febe438da9fde8f8c227e4d183d21ce835ba4ee6f1867192034a8d853a6a33384b40a90ce47b9db861f42ba306b5dbef5b1ef333b9e915d486cda8d4dc44905d44076f279acb6272c8a28a7cb580fe4e33a4cddc8d00976c2a0bf112fc9cd5bc690d87d88811d8946d80b26534b35dc451b87304b0c92834abb9d6cd88bb1111e47dccda156abac3a82174b5b2f9a7388a7d19b499911330b47353cae0be0aa0b797cde922981f6c7b8becd91735eb50d92e35cc14995889c35cb887b3b73d49a2c5e4fde822407668a19ec316dde697f44eca932e0c7829e5060e80a418b842c4c77882f94b57d7bd974fcd109f35206558aa201c2435a2cd16726a18ccd3a664533f206c9feaf7c2ac94f704cbf3c7eda7fa6f4f3d5e346c5b60f42bf55d656c345b8284c21253153d3137a02635f80bf2f84dc64cf32ff8cbb50810f3c932a3a5c1',
            '0x62a79f2c1e95f002a17d64f996f2980d50e369efce0a1e38220df24240f1efadb6ea0ebe73cecee355af55699756008548435958ec9e17c82b6f477401e9b3433359d198afb5483a8462a48429c9584a54160dabefa8c45b30c3e694280ddbc73525cafb38fa1ebab469c8fc1aa12246da1d54e9c0e73a0d598e58fbec2c092953ba1d62a3d544d0f8bf82853aa4d24e63ae9aad46f8439265c9a66212cfa516ccec59fc656d534e35922784b84c8da985dc11449ed64edd01296c2eb7febe438da9fde8f8c227e4d183d21ce835ba4ee6f1867192034a8d853a6a33384b40a90ce47b9db861f42ba306b5dbef5b1ef333b9e915d486cda8d4dc44905d44076f279acb6272c8a28a7cb580fe4e33a4cddc8d00976c2a0bf112fc9cd5bc690d87d88811d8946d80b26534b35dc451b87304b0c92834abb9d6cd88bb1111e47dccda156abac3a82174b5b2f9a7388a7d19b499911330b47353cae0be0aa0b797cde922981f6c7b8becd91735eb50d92e35cc14995889c35cb887b3b73d49a2c5e4fde822407668a19ec316dde697f44eca932e0c7829e5060e80a418b842c4c77882f94b57d7bd974fcd109f35206558aa201c2435a2cd16726a18ccd3a664533f206c9feaf7c2ac94f704cbf3c7eda7fa6f4f3d5e346c5b60f42bf55d656c345b8284c21253153d3137a02635f80bf2f84dc64cf32ff8cbb50810f3c932a3a5c1',
          ],
        prime1 =>  [
            Math::BigInt->from_hex('0xcf0497e588b2860bf980392966914a2ee6bd46049c23a2884b75fd2cb918b65ad060223e21d416c397abe932f25d442f091f9282052d12706ef7a475c2fa3f34ca48a78d81374ce125832fc5d213a223a86868d327feed7d04db35817dd76dbae9457019074cc03192a0ebfa88891f545991c1158bea9489ebb9e0df05a001e17fe82078258c59d0d802bc0f78467f2c3ef6d6a4663f582b609148adac798bc13634a381a0d249a4abe77981bfbf4d6ad36db2af88af0681178303ac093510a9497a28aaf1aaa4ec6ed7b48c9adf9f5f2e38cb044bd0165a196cc8e7f993f6658aafe5f3c20c6e5a2dbaf243d6ef6310f43fbf43aea7ff7ea61cac088062e593'),
            '0xcf0497e588b2860bf980392966914a2ee6bd46049c23a2884b75fd2cb918b65ad060223e21d416c397abe932f25d442f091f9282052d12706ef7a475c2fa3f34ca48a78d81374ce125832fc5d213a223a86868d327feed7d04db35817dd76dbae9457019074cc03192a0ebfa88891f545991c1158bea9489ebb9e0df05a001e17fe82078258c59d0d802bc0f78467f2c3ef6d6a4663f582b609148adac798bc13634a381a0d249a4abe77981bfbf4d6ad36db2af88af0681178303ac093510a9497a28aaf1aaa4ec6ed7b48c9adf9f5f2e38cb044bd0165a196cc8e7f993f6658aafe5f3c20c6e5a2dbaf243d6ef6310f43fbf43aea7ff7ea61cac088062e593',
            '0x00cf0497e588b2860bf980392966914a2ee6bd46049c23a2884b75fd2cb918b65ad060223e21d416c397abe932f25d442f091f9282052d12706ef7a475c2fa3f34ca48a78d81374ce125832fc5d213a223a86868d327feed7d04db35817dd76dbae9457019074cc03192a0ebfa88891f545991c1158bea9489ebb9e0df05a001e17fe82078258c59d0d802bc0f78467f2c3ef6d6a4663f582b609148adac798bc13634a381a0d249a4abe77981bfbf4d6ad36db2af88af0681178303ac093510a9497a28aaf1aaa4ec6ed7b48c9adf9f5f2e38cb044bd0165a196cc8e7f993f6658aafe5f3c20c6e5a2dbaf243d6ef6310f43fbf43aea7ff7ea61cac088062e593',
          ],
        prime2 =>  [
            Math::BigInt->from_hex('0xc394a164030fc30649674ddc43594cd787f6db9e0ebdbb6075cc6b0eef4e72970f219a9e919ff89a9ba094deaa81bc8a83ba6c955a65c377ab2be9c18eec028e60033750446af0824acfbb2212249190ffbff6c23a4671e42397d71bc685ff0681676405fe9517ecf85186e35604b263fb6b0598f7e9cd9945bd456b740ced6b68ea0792c5c410ac57b5a846cc7c4bdefce7df6f44b26d96d0fa38ffba6e21c9f2f2603b9e7cf437be8a1fb02dd1bec4526408180c93c04c3949123691ca768ec9a515463cb70280a9f48fc24ad023cb1f664186029940873cda202a8d9fb63ef25f9b2f1a0408bef6a621803d0ea5c118252e2c7099eb814f0a6cea1c6e6fdb'),
            '0xc394a164030fc30649674ddc43594cd787f6db9e0ebdbb6075cc6b0eef4e72970f219a9e919ff89a9ba094deaa81bc8a83ba6c955a65c377ab2be9c18eec028e60033750446af0824acfbb2212249190ffbff6c23a4671e42397d71bc685ff0681676405fe9517ecf85186e35604b263fb6b0598f7e9cd9945bd456b740ced6b68ea0792c5c410ac57b5a846cc7c4bdefce7df6f44b26d96d0fa38ffba6e21c9f2f2603b9e7cf437be8a1fb02dd1bec4526408180c93c04c3949123691ca768ec9a515463cb70280a9f48fc24ad023cb1f664186029940873cda202a8d9fb63ef25f9b2f1a0408bef6a621803d0ea5c118252e2c7099eb814f0a6cea1c6e6fdb',
            '0x00c394a164030fc30649674ddc43594cd787f6db9e0ebdbb6075cc6b0eef4e72970f219a9e919ff89a9ba094deaa81bc8a83ba6c955a65c377ab2be9c18eec028e60033750446af0824acfbb2212249190ffbff6c23a4671e42397d71bc685ff0681676405fe9517ecf85186e35604b263fb6b0598f7e9cd9945bd456b740ced6b68ea0792c5c410ac57b5a846cc7c4bdefce7df6f44b26d96d0fa38ffba6e21c9f2f2603b9e7cf437be8a1fb02dd1bec4526408180c93c04c3949123691ca768ec9a515463cb70280a9f48fc24ad023cb1f664186029940873cda202a8d9fb63ef25f9b2f1a0408bef6a621803d0ea5c118252e2c7099eb814f0a6cea1c6e6fdb',
          ],
    },
    't/rsa-8k.der'    =>    {
        modulus =>  [
            Math::BigInt->from_hex('0xa0e9a5efa73c4d47f603c3c5ee6cc09cb84e137effc453c408ec96550ad7655581c760b710b8b8b29b602ea90c595314b3c2b074bc40bf2e763271916dd180e61bc24036c222a4cd027a973aada0c29047f0fb52190c7ba0700145fe84569b20e7afcd31d4dd91f9b2ee287c93586b2c0fb56b430b3cf534f0555d8f139e4841f0004b5194f510b809d438448527ba8ac6ada324b694a7f9bf2a52cf81ca9798b3d69f484aa97946be56793678f30ccbddf0d0f85ed1ac46d8efd1adfc7e7641a5e940f49b9320fcbe89ed63f518232bf1d380aa03e1ed8f58f7cbfd4447db640a4258b302a341ecf34fa84dea4fd31f460be0018a55d88f82d91b90f3e2d1569114998fd0e3c2b6b801a81e405418fa45929c1c8d61a1abb1974d64f33b8b4c614eb7952184af1836159b074fdf25156a59b503f0f19f45da1491fc173fc5e346eac6a117e9fd620e3cc7ed5fc10ff22cf49fe6d07fc5906355a712e6aea429380fa7f902aa9a36117f54bf9cad7fbb37b76ce26809e33c6f9bb976e27d040423d0e4ea496916181f525e39366f3ee2ea45aaec4e1c38390a3cff177ceac2224e621c5da415d50b5f7b45071b304918eda85144912a8ee92a363eb408e2931a0318cca3426f0e27eea27b2e9fbe976bd49c58cf6156fa894ef95adba44ea43954c3e898daa8f7361e86475fb9e29ae336fcb7ba6c1ec6846987fc057b72ec4a9f9afc26e821d25663d54e398636d3741b3452956f5a96f5d42179288a85c46ca2bf5dc1d4fee1215e33f6c79ed33fc499af6a8b6e49626ce42f0996174dd20677cdca6fa103bc3a91ea083d3cfa3bd875878d7d6cb26f92c2f219f547cc349d4d88c81a10318d304b559e3827e00c2fe4294d0912f1a1129e36c7c5b41cb9acc92b1a9430c50b3db39b7d9ec82aca1e1d555c8f299539bc7bcf1f65c308c21d9f0f1be6c5b5e036575052e7336278c94aa8c07c24e0e8ea0410200012d6c2af5be318924f43eebb6636410b7d03a77a18dad7010ef943e25a3174b1af48a81839fd240b05579f6f35fd68d11d2f367ccbd6aedf94bd0788080f5e32e1c56307e66a2f2081cba2393bf7125f2bfb19a8e54d9094509da379f819870574b23419e95c4d58682a1eb56b98a2c25995d3943b89960e9ccfb9e5eb0a12856e44604688edca08b0712914fdd8788ac29517e156c7a014f8116e6a38d85ca2b070b5fd114bee14fffe4547e72fcd181ab966e2a87d54e5952f42448706ccc9eb7593aaaec8aea64ae662da7f0d4b2391d3733365c2b509ebdf00451f3911b031e46f9fc64d6088d66c0c0dacf81e3e5d9c8887a13e17a20d96a1c2f21c266195e312739e0bc1742d2c7595a7b84a76d997d3f61cb66d24bf808f8b5051ec35f607c235b47a36b0926ac13f8c3a79cc4d0131bb75137848a02131f9b49e5d48ad8ef391'),
            '0xa0e9a5efa73c4d47f603c3c5ee6cc09cb84e137effc453c408ec96550ad7655581c760b710b8b8b29b602ea90c595314b3c2b074bc40bf2e763271916dd180e61bc24036c222a4cd027a973aada0c29047f0fb52190c7ba0700145fe84569b20e7afcd31d4dd91f9b2ee287c93586b2c0fb56b430b3cf534f0555d8f139e4841f0004b5194f510b809d438448527ba8ac6ada324b694a7f9bf2a52cf81ca9798b3d69f484aa97946be56793678f30ccbddf0d0f85ed1ac46d8efd1adfc7e7641a5e940f49b9320fcbe89ed63f518232bf1d380aa03e1ed8f58f7cbfd4447db640a4258b302a341ecf34fa84dea4fd31f460be0018a55d88f82d91b90f3e2d1569114998fd0e3c2b6b801a81e405418fa45929c1c8d61a1abb1974d64f33b8b4c614eb7952184af1836159b074fdf25156a59b503f0f19f45da1491fc173fc5e346eac6a117e9fd620e3cc7ed5fc10ff22cf49fe6d07fc5906355a712e6aea429380fa7f902aa9a36117f54bf9cad7fbb37b76ce26809e33c6f9bb976e27d040423d0e4ea496916181f525e39366f3ee2ea45aaec4e1c38390a3cff177ceac2224e621c5da415d50b5f7b45071b304918eda85144912a8ee92a363eb408e2931a0318cca3426f0e27eea27b2e9fbe976bd49c58cf6156fa894ef95adba44ea43954c3e898daa8f7361e86475fb9e29ae336fcb7ba6c1ec6846987fc057b72ec4a9f9afc26e821d25663d54e398636d3741b3452956f5a96f5d42179288a85c46ca2bf5dc1d4fee1215e33f6c79ed33fc499af6a8b6e49626ce42f0996174dd20677cdca6fa103bc3a91ea083d3cfa3bd875878d7d6cb26f92c2f219f547cc349d4d88c81a10318d304b559e3827e00c2fe4294d0912f1a1129e36c7c5b41cb9acc92b1a9430c50b3db39b7d9ec82aca1e1d555c8f299539bc7bcf1f65c308c21d9f0f1be6c5b5e036575052e7336278c94aa8c07c24e0e8ea0410200012d6c2af5be318924f43eebb6636410b7d03a77a18dad7010ef943e25a3174b1af48a81839fd240b05579f6f35fd68d11d2f367ccbd6aedf94bd0788080f5e32e1c56307e66a2f2081cba2393bf7125f2bfb19a8e54d9094509da379f819870574b23419e95c4d58682a1eb56b98a2c25995d3943b89960e9ccfb9e5eb0a12856e44604688edca08b0712914fdd8788ac29517e156c7a014f8116e6a38d85ca2b070b5fd114bee14fffe4547e72fcd181ab966e2a87d54e5952f42448706ccc9eb7593aaaec8aea64ae662da7f0d4b2391d3733365c2b509ebdf00451f3911b031e46f9fc64d6088d66c0c0dacf81e3e5d9c8887a13e17a20d96a1c2f21c266195e312739e0bc1742d2c7595a7b84a76d997d3f61cb66d24bf808f8b5051ec35f607c235b47a36b0926ac13f8c3a79cc4d0131bb75137848a02131f9b49e5d48ad8ef391',
            '0x00a0e9a5efa73c4d47f603c3c5ee6cc09cb84e137effc453c408ec96550ad7655581c760b710b8b8b29b602ea90c595314b3c2b074bc40bf2e763271916dd180e61bc24036c222a4cd027a973aada0c29047f0fb52190c7ba0700145fe84569b20e7afcd31d4dd91f9b2ee287c93586b2c0fb56b430b3cf534f0555d8f139e4841f0004b5194f510b809d438448527ba8ac6ada324b694a7f9bf2a52cf81ca9798b3d69f484aa97946be56793678f30ccbddf0d0f85ed1ac46d8efd1adfc7e7641a5e940f49b9320fcbe89ed63f518232bf1d380aa03e1ed8f58f7cbfd4447db640a4258b302a341ecf34fa84dea4fd31f460be0018a55d88f82d91b90f3e2d1569114998fd0e3c2b6b801a81e405418fa45929c1c8d61a1abb1974d64f33b8b4c614eb7952184af1836159b074fdf25156a59b503f0f19f45da1491fc173fc5e346eac6a117e9fd620e3cc7ed5fc10ff22cf49fe6d07fc5906355a712e6aea429380fa7f902aa9a36117f54bf9cad7fbb37b76ce26809e33c6f9bb976e27d040423d0e4ea496916181f525e39366f3ee2ea45aaec4e1c38390a3cff177ceac2224e621c5da415d50b5f7b45071b304918eda85144912a8ee92a363eb408e2931a0318cca3426f0e27eea27b2e9fbe976bd49c58cf6156fa894ef95adba44ea43954c3e898daa8f7361e86475fb9e29ae336fcb7ba6c1ec6846987fc057b72ec4a9f9afc26e821d25663d54e398636d3741b3452956f5a96f5d42179288a85c46ca2bf5dc1d4fee1215e33f6c79ed33fc499af6a8b6e49626ce42f0996174dd20677cdca6fa103bc3a91ea083d3cfa3bd875878d7d6cb26f92c2f219f547cc349d4d88c81a10318d304b559e3827e00c2fe4294d0912f1a1129e36c7c5b41cb9acc92b1a9430c50b3db39b7d9ec82aca1e1d555c8f299539bc7bcf1f65c308c21d9f0f1be6c5b5e036575052e7336278c94aa8c07c24e0e8ea0410200012d6c2af5be318924f43eebb6636410b7d03a77a18dad7010ef943e25a3174b1af48a81839fd240b05579f6f35fd68d11d2f367ccbd6aedf94bd0788080f5e32e1c56307e66a2f2081cba2393bf7125f2bfb19a8e54d9094509da379f819870574b23419e95c4d58682a1eb56b98a2c25995d3943b89960e9ccfb9e5eb0a12856e44604688edca08b0712914fdd8788ac29517e156c7a014f8116e6a38d85ca2b070b5fd114bee14fffe4547e72fcd181ab966e2a87d54e5952f42448706ccc9eb7593aaaec8aea64ae662da7f0d4b2391d3733365c2b509ebdf00451f3911b031e46f9fc64d6088d66c0c0dacf81e3e5d9c8887a13e17a20d96a1c2f21c266195e312739e0bc1742d2c7595a7b84a76d997d3f61cb66d24bf808f8b5051ec35f607c235b47a36b0926ac13f8c3a79cc4d0131bb75137848a02131f9b49e5d48ad8ef391',
          ],
        privateExponent =>  [
            Math::BigInt->from_hex('0x46a750dcf1a960a5803816f609c266b0699c9ea2dcdaef8cdbfe45e40166a26ff114023b5f743c64f0244358a6bb71e75d26d723eaa4e34d1b48fae4c83b7d458c5ab6a75486b1a5f2b8b13e6a8e73dfb636f1a312ac907bd9b2357193da13335787b1a977b5f22a998e48e8aa29e0a4f020d08017a72463a2435959415bf68e3d3b63d6e678d4667aaa5c2a79ecffd37f792e71285a0d877390b9dbb339a966bb5039901c785d6fda934d95c575b2e0b10ad436ba2b8661754f97d9b54c31d09170e1bc85b30c80ed88d25b597ac7b6bbf00a469c7dcf3969ef23fa88c8a46440bcf10568db164f5c6655982091fc3977202fb37d72442c7f5fa4e2f8b35707939c5ff0eddf93d776e40355851967fe3c1e2bbdbdb668ae62c3f48fa6dd3644cb552cf6a6490438b546b75376969c49d2f0a0b2a250f5864e4349f64e9f09dcc97ebcc86f1fa6ca2f4630e2e1707bf7f215574099bc009b6d826661be38608c58b9471fe733d1927c0c54c1eda1a0bc2bb2b674930a0464bcfcbb6a9ff814935cc6943ceb0ee14ca6341c7b329396213c8c6a8867a3ac6c1f3ab9272f0a45439af7294d5486e18ca4d8136f1359183f81daae1455494286ceaa12ce2a38922e91bd89dd05868dc8aad75d0f13c533e77ceb49738562138fc6c566479ad58cf63f69e5ef77d348f8d25e53688cce1b043958adb38555de04b5f1a78f20ad4d62a483af7f2ead309a751ea06be16b0771761d21b2c3d235ae50c31f3e850ae5578a9f53fdb4b33299fb7948d54e944a97c21d938e6b9fdd09c927064ab2bb150dc146005cbe412b9c43db7cee2d05ad07c3f75f1fdfb8233e3ef09394d3b9ed9f872cbe38c4e805dad4da79498b48ca62bb967978cba47ef8436b7672f247f2d41d3a7845cede52233a4028f62e365d78c960ecfc62d71e9ca04dd992dafe0cc1e6ca5d6bae2323706dda8fbaf59b586cd3f06ff8355c41e564c1fcb02b3ec09b176b70c913b76170135c3a7bca97b14604e1978c7a929a64c1282b6024d17c5cb96a9794684baef40b3fb2b66b709327b926eaaba9596bf53dcbd87930263090b81f563754f8bdcdb42db23859a5fa147b834e788b6e36d668baccdbc957de7a84d28b04954aa71a219242f58ec31986fe69e1db296aee4e50bb2db4b22ed0dd45caf77f6105f3a9c2c0144fd3958b7daf2e12384f04a492405520347ec7d9a9b9fe67a8257df0ec9bdbcd637aa7950dfc8ce7eb5f4a87d7a2ab600a09ef874b0a8686ea3ad9c26cfb750c05d7d32a9935170b227853c6ba3712cb066ed26b5295c92c077ea6ed5087709dd56a56aea9b3c7db1e7b0b679b51c94d97ca161a5c6baa8c1ad249b3c03fdb25cd85109d9fe61341e5869bcf2ef66639f6e6436149715f99416b0e3f39c672df37053a469a769650581de8e54bc3896b821beaf921'),
            '0x46a750dcf1a960a5803816f609c266b0699c9ea2dcdaef8cdbfe45e40166a26ff114023b5f743c64f0244358a6bb71e75d26d723eaa4e34d1b48fae4c83b7d458c5ab6a75486b1a5f2b8b13e6a8e73dfb636f1a312ac907bd9b2357193da13335787b1a977b5f22a998e48e8aa29e0a4f020d08017a72463a2435959415bf68e3d3b63d6e678d4667aaa5c2a79ecffd37f792e71285a0d877390b9dbb339a966bb5039901c785d6fda934d95c575b2e0b10ad436ba2b8661754f97d9b54c31d09170e1bc85b30c80ed88d25b597ac7b6bbf00a469c7dcf3969ef23fa88c8a46440bcf10568db164f5c6655982091fc3977202fb37d72442c7f5fa4e2f8b35707939c5ff0eddf93d776e40355851967fe3c1e2bbdbdb668ae62c3f48fa6dd3644cb552cf6a6490438b546b75376969c49d2f0a0b2a250f5864e4349f64e9f09dcc97ebcc86f1fa6ca2f4630e2e1707bf7f215574099bc009b6d826661be38608c58b9471fe733d1927c0c54c1eda1a0bc2bb2b674930a0464bcfcbb6a9ff814935cc6943ceb0ee14ca6341c7b329396213c8c6a8867a3ac6c1f3ab9272f0a45439af7294d5486e18ca4d8136f1359183f81daae1455494286ceaa12ce2a38922e91bd89dd05868dc8aad75d0f13c533e77ceb49738562138fc6c566479ad58cf63f69e5ef77d348f8d25e53688cce1b043958adb38555de04b5f1a78f20ad4d62a483af7f2ead309a751ea06be16b0771761d21b2c3d235ae50c31f3e850ae5578a9f53fdb4b33299fb7948d54e944a97c21d938e6b9fdd09c927064ab2bb150dc146005cbe412b9c43db7cee2d05ad07c3f75f1fdfb8233e3ef09394d3b9ed9f872cbe38c4e805dad4da79498b48ca62bb967978cba47ef8436b7672f247f2d41d3a7845cede52233a4028f62e365d78c960ecfc62d71e9ca04dd992dafe0cc1e6ca5d6bae2323706dda8fbaf59b586cd3f06ff8355c41e564c1fcb02b3ec09b176b70c913b76170135c3a7bca97b14604e1978c7a929a64c1282b6024d17c5cb96a9794684baef40b3fb2b66b709327b926eaaba9596bf53dcbd87930263090b81f563754f8bdcdb42db23859a5fa147b834e788b6e36d668baccdbc957de7a84d28b04954aa71a219242f58ec31986fe69e1db296aee4e50bb2db4b22ed0dd45caf77f6105f3a9c2c0144fd3958b7daf2e12384f04a492405520347ec7d9a9b9fe67a8257df0ec9bdbcd637aa7950dfc8ce7eb5f4a87d7a2ab600a09ef874b0a8686ea3ad9c26cfb750c05d7d32a9935170b227853c6ba3712cb066ed26b5295c92c077ea6ed5087709dd56a56aea9b3c7db1e7b0b679b51c94d97ca161a5c6baa8c1ad249b3c03fdb25cd85109d9fe61341e5869bcf2ef66639f6e6436149715f99416b0e3f39c672df37053a469a769650581de8e54bc3896b821beaf921',
            '0x46a750dcf1a960a5803816f609c266b0699c9ea2dcdaef8cdbfe45e40166a26ff114023b5f743c64f0244358a6bb71e75d26d723eaa4e34d1b48fae4c83b7d458c5ab6a75486b1a5f2b8b13e6a8e73dfb636f1a312ac907bd9b2357193da13335787b1a977b5f22a998e48e8aa29e0a4f020d08017a72463a2435959415bf68e3d3b63d6e678d4667aaa5c2a79ecffd37f792e71285a0d877390b9dbb339a966bb5039901c785d6fda934d95c575b2e0b10ad436ba2b8661754f97d9b54c31d09170e1bc85b30c80ed88d25b597ac7b6bbf00a469c7dcf3969ef23fa88c8a46440bcf10568db164f5c6655982091fc3977202fb37d72442c7f5fa4e2f8b35707939c5ff0eddf93d776e40355851967fe3c1e2bbdbdb668ae62c3f48fa6dd3644cb552cf6a6490438b546b75376969c49d2f0a0b2a250f5864e4349f64e9f09dcc97ebcc86f1fa6ca2f4630e2e1707bf7f215574099bc009b6d826661be38608c58b9471fe733d1927c0c54c1eda1a0bc2bb2b674930a0464bcfcbb6a9ff814935cc6943ceb0ee14ca6341c7b329396213c8c6a8867a3ac6c1f3ab9272f0a45439af7294d5486e18ca4d8136f1359183f81daae1455494286ceaa12ce2a38922e91bd89dd05868dc8aad75d0f13c533e77ceb49738562138fc6c566479ad58cf63f69e5ef77d348f8d25e53688cce1b043958adb38555de04b5f1a78f20ad4d62a483af7f2ead309a751ea06be16b0771761d21b2c3d235ae50c31f3e850ae5578a9f53fdb4b33299fb7948d54e944a97c21d938e6b9fdd09c927064ab2bb150dc146005cbe412b9c43db7cee2d05ad07c3f75f1fdfb8233e3ef09394d3b9ed9f872cbe38c4e805dad4da79498b48ca62bb967978cba47ef8436b7672f247f2d41d3a7845cede52233a4028f62e365d78c960ecfc62d71e9ca04dd992dafe0cc1e6ca5d6bae2323706dda8fbaf59b586cd3f06ff8355c41e564c1fcb02b3ec09b176b70c913b76170135c3a7bca97b14604e1978c7a929a64c1282b6024d17c5cb96a9794684baef40b3fb2b66b709327b926eaaba9596bf53dcbd87930263090b81f563754f8bdcdb42db23859a5fa147b834e788b6e36d668baccdbc957de7a84d28b04954aa71a219242f58ec31986fe69e1db296aee4e50bb2db4b22ed0dd45caf77f6105f3a9c2c0144fd3958b7daf2e12384f04a492405520347ec7d9a9b9fe67a8257df0ec9bdbcd637aa7950dfc8ce7eb5f4a87d7a2ab600a09ef874b0a8686ea3ad9c26cfb750c05d7d32a9935170b227853c6ba3712cb066ed26b5295c92c077ea6ed5087709dd56a56aea9b3c7db1e7b0b679b51c94d97ca161a5c6baa8c1ad249b3c03fdb25cd85109d9fe61341e5869bcf2ef66639f6e6436149715f99416b0e3f39c672df37053a469a769650581de8e54bc3896b821beaf921',
          ],
        prime1 =>  [
            Math::BigInt->from_hex('0xccd04ef7237e2f3d4f9ad34f1fa41cd685f5a2c95951dcec969f9ddf880faf2452c50b71dc4a29b9d8ac5873d2fc30f12a480be3cee6ece15d597ba3e96a814d70b8bf20cedba0519d6e483d08f566fea4a938c047937450a3c06f57ab845a81ed0987375b4ac48684cd488cdb97d76ff9ae0e408c85ddf4dd344e714a0f157936302b092f8b26096683101af9e677ebe1dd2da7b61308502afdfb5459951fd5a40e2625d879a7ac6df58b16229274278f975737300303838d684c0f4299b72a07dfcf5a3790654838f29005fae755b0457c4f222a47215872964398659fca9eff6594970bd81e1033213e5cf6287e6a5105415c0bc6bf52a803153bbef9b88ba1fa11572f9de6aee3cc84c6c3eeae89f1166a1bb56382aebfc2ae6245444aac9f07e319f3182707179a19f52ad4dce6c19b5601c8d776dbab0bf509a8def446031b6d878820a83c1b5b9f9574563f22bc1621fef1a86756e62840f9a0922a0ebce52600842671007c311ce88c512ff71abb595818cd4e408719ae5bd44e68e3d1387a93d9c6ed2b742281ecde1add901ac097290854a11a39ac5bab6e978e8b2516778dc970de35fd3621bbf2094a2aeefabaaba3be1c37863a23bd81eeaa42de5814959af7b691e35a3986d4f87e03bde45b003ed8dd41c2eb9938fd74ac51606c39e5fb1ccbeb398a53f0ae0d2ddec5ea71f2bea82a08043d52c7b43afa7b'),
            '0xccd04ef7237e2f3d4f9ad34f1fa41cd685f5a2c95951dcec969f9ddf880faf2452c50b71dc4a29b9d8ac5873d2fc30f12a480be3cee6ece15d597ba3e96a814d70b8bf20cedba0519d6e483d08f566fea4a938c047937450a3c06f57ab845a81ed0987375b4ac48684cd488cdb97d76ff9ae0e408c85ddf4dd344e714a0f157936302b092f8b26096683101af9e677ebe1dd2da7b61308502afdfb5459951fd5a40e2625d879a7ac6df58b16229274278f975737300303838d684c0f4299b72a07dfcf5a3790654838f29005fae755b0457c4f222a47215872964398659fca9eff6594970bd81e1033213e5cf6287e6a5105415c0bc6bf52a803153bbef9b88ba1fa11572f9de6aee3cc84c6c3eeae89f1166a1bb56382aebfc2ae6245444aac9f07e319f3182707179a19f52ad4dce6c19b5601c8d776dbab0bf509a8def446031b6d878820a83c1b5b9f9574563f22bc1621fef1a86756e62840f9a0922a0ebce52600842671007c311ce88c512ff71abb595818cd4e408719ae5bd44e68e3d1387a93d9c6ed2b742281ecde1add901ac097290854a11a39ac5bab6e978e8b2516778dc970de35fd3621bbf2094a2aeefabaaba3be1c37863a23bd81eeaa42de5814959af7b691e35a3986d4f87e03bde45b003ed8dd41c2eb9938fd74ac51606c39e5fb1ccbeb398a53f0ae0d2ddec5ea71f2bea82a08043d52c7b43afa7b',
            '0x00ccd04ef7237e2f3d4f9ad34f1fa41cd685f5a2c95951dcec969f9ddf880faf2452c50b71dc4a29b9d8ac5873d2fc30f12a480be3cee6ece15d597ba3e96a814d70b8bf20cedba0519d6e483d08f566fea4a938c047937450a3c06f57ab845a81ed0987375b4ac48684cd488cdb97d76ff9ae0e408c85ddf4dd344e714a0f157936302b092f8b26096683101af9e677ebe1dd2da7b61308502afdfb5459951fd5a40e2625d879a7ac6df58b16229274278f975737300303838d684c0f4299b72a07dfcf5a3790654838f29005fae755b0457c4f222a47215872964398659fca9eff6594970bd81e1033213e5cf6287e6a5105415c0bc6bf52a803153bbef9b88ba1fa11572f9de6aee3cc84c6c3eeae89f1166a1bb56382aebfc2ae6245444aac9f07e319f3182707179a19f52ad4dce6c19b5601c8d776dbab0bf509a8def446031b6d878820a83c1b5b9f9574563f22bc1621fef1a86756e62840f9a0922a0ebce52600842671007c311ce88c512ff71abb595818cd4e408719ae5bd44e68e3d1387a93d9c6ed2b742281ecde1add901ac097290854a11a39ac5bab6e978e8b2516778dc970de35fd3621bbf2094a2aeefabaaba3be1c37863a23bd81eeaa42de5814959af7b691e35a3986d4f87e03bde45b003ed8dd41c2eb9938fd74ac51606c39e5fb1ccbeb398a53f0ae0d2ddec5ea71f2bea82a08043d52c7b43afa7b',
          ],
        prime2 =>  [
            Math::BigInt->from_hex('0xc9209d5c7ab9b4d291c36f143b8652705720280145bec46c1c1d93d0c3bf5e1170b9ecb5193907485db7681ba5e45b3a179a6b6e0d9259d855eed32df40bd02e7946fdc2d74cac8d14280becc19d1e2ddbfa8ee44c8ca0f51895ec543d6bec6281328e0e72d92a6d0b05c0e3204728c2fe8a6e42addf9ab862d16bc016afdd50aead987fc47b264fbbe0ac3b13b053333d298df0c6acf41caf85d36cf7b69b853a05d5513a896d3e87d3147d4027ee5a97b87c0d77a3668f53c99ef8801c33808f3d5bf7c92006a4bd6adaba2a2f252f54c2b304619bac0bb01ee34e857fdc479259eafcb1afb1c4fa922aaf1915f645c15c2d14e68183eeaff6737b0258eed198347d85c07dfcf5b911f140558f2015dd95ca0ec24f87bc7ddcab079f6b47b4dbc1ce2ccde5cd8169e02cec0e26e086677d5f1b51515ea4a08ebf537d572922fb2dfb560608b8ca2aa35be9a276a709f33227fbf734f85a60ed73c144da45be2f9aef4ecc3624e472d1e9331d4a411e7f5b07caa0d72db72f3a508e99066af31e079d538c0f9ce8ec4bb987cd5559f548ba846becceead2615774f53b3702c556066d47d1da435740b8c22aced24aabd0ec794d9d125c1048c134ce6d5d0f223f6409a0bd02a8dd04acdf65a322b140fb152f50c41cdcd293b00db1997878c6a06946960766a2582fd82a9c06b547a5323fcf0ccde453d76b70a2c6f0876263'),
            '0xc9209d5c7ab9b4d291c36f143b8652705720280145bec46c1c1d93d0c3bf5e1170b9ecb5193907485db7681ba5e45b3a179a6b6e0d9259d855eed32df40bd02e7946fdc2d74cac8d14280becc19d1e2ddbfa8ee44c8ca0f51895ec543d6bec6281328e0e72d92a6d0b05c0e3204728c2fe8a6e42addf9ab862d16bc016afdd50aead987fc47b264fbbe0ac3b13b053333d298df0c6acf41caf85d36cf7b69b853a05d5513a896d3e87d3147d4027ee5a97b87c0d77a3668f53c99ef8801c33808f3d5bf7c92006a4bd6adaba2a2f252f54c2b304619bac0bb01ee34e857fdc479259eafcb1afb1c4fa922aaf1915f645c15c2d14e68183eeaff6737b0258eed198347d85c07dfcf5b911f140558f2015dd95ca0ec24f87bc7ddcab079f6b47b4dbc1ce2ccde5cd8169e02cec0e26e086677d5f1b51515ea4a08ebf537d572922fb2dfb560608b8ca2aa35be9a276a709f33227fbf734f85a60ed73c144da45be2f9aef4ecc3624e472d1e9331d4a411e7f5b07caa0d72db72f3a508e99066af31e079d538c0f9ce8ec4bb987cd5559f548ba846becceead2615774f53b3702c556066d47d1da435740b8c22aced24aabd0ec794d9d125c1048c134ce6d5d0f223f6409a0bd02a8dd04acdf65a322b140fb152f50c41cdcd293b00db1997878c6a06946960766a2582fd82a9c06b547a5323fcf0ccde453d76b70a2c6f0876263',
            '0x00c9209d5c7ab9b4d291c36f143b8652705720280145bec46c1c1d93d0c3bf5e1170b9ecb5193907485db7681ba5e45b3a179a6b6e0d9259d855eed32df40bd02e7946fdc2d74cac8d14280becc19d1e2ddbfa8ee44c8ca0f51895ec543d6bec6281328e0e72d92a6d0b05c0e3204728c2fe8a6e42addf9ab862d16bc016afdd50aead987fc47b264fbbe0ac3b13b053333d298df0c6acf41caf85d36cf7b69b853a05d5513a896d3e87d3147d4027ee5a97b87c0d77a3668f53c99ef8801c33808f3d5bf7c92006a4bd6adaba2a2f252f54c2b304619bac0bb01ee34e857fdc479259eafcb1afb1c4fa922aaf1915f645c15c2d14e68183eeaff6737b0258eed198347d85c07dfcf5b911f140558f2015dd95ca0ec24f87bc7ddcab079f6b47b4dbc1ce2ccde5cd8169e02cec0e26e086677d5f1b51515ea4a08ebf537d572922fb2dfb560608b8ca2aa35be9a276a709f33227fbf734f85a60ed73c144da45be2f9aef4ecc3624e472d1e9331d4a411e7f5b07caa0d72db72f3a508e99066af31e079d538c0f9ce8ec4bb987cd5559f548ba846becceead2615774f53b3702c556066d47d1da435740b8c22aced24aabd0ec794d9d125c1048c134ce6d5d0f223f6409a0bd02a8dd04acdf65a322b140fb152f50c41cdcd293b00db1997878c6a06946960766a2582fd82a9c06b547a5323fcf0ccde453d76b70a2c6f0876263',
          ],
    },
);

for my $file (sort keys %keys) {
  print "# $file\n";
  my $key = loadkey($file);
  my $keyinfo = $keys{$file};
  for (my$x=0;$x<=$#testf;$x++) {
    my $bi = $testf[$x];
    $asn->configure( decode => { bigint => $bi->[0] }, encode => { bigint => $bi->[0] } );
    print "# $bi->[0]\n";
    btest $t++, my $struct = $parser->decode($key);
    btest $t++, my $enc = $parser->encode($struct);
    stest $t++, $key, $enc;
    #### speed test
    # if ($bi->[0] eq 'twos') {
      # for (0..100) {
        # my $data2 = $parser->decode($key);
      # }
    # }
    $struct ||= {};
    foreach my $part (sort keys %{$keyinfo}) {
      # print "# $part\n";
      $bi->[1]->($t++, $keyinfo->{$part}->[$x], lc($struct->{$part}));
    }
  }
}


sub loadkey {
  my $file = shift;
  open FILE, $file || die "cannot load test certificate" . $file . "\n";
  binmode FILE;    # HELLO Windows, dont fuss with this
  my $holdTerminator = $/;
  undef $/;        # using slurp mode to read the DER-encoded binary certificate
  my $key = <FILE>;
  $/ = $holdTerminator;
  close FILE;
  return $key;
}
